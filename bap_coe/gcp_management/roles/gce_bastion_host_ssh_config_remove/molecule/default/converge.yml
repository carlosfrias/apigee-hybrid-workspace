---
- name: Converge
  hosts: localhost
  connection: local
  gather_facts: false
  no_log: "{{ molecule_no_log }}"

  vars_files:
  - shared-properties.yml

  collections:
  - bap_coe.gcp_management

  tasks:
  - name: Create Bastion Host instance
    include_role:
      name: gce_bastion_host_create

  - name: Configure SSH ProxyCommand
    include_role:
      name: gce_bastion_host_ssh_config
    vars:
      bastion_host_name: "{{ gce_instance_ext_name }}"
      bastion_host_user: "friasc"
      bastion_host_ip: "{{ gce_instance_ext_IP }}"



