---
# tasks file for gcp_auth_service_account_activate

- name: Assert SERVICE_ACCOUNT_NAME is provided
  assert:
    that:
    - SERVICE_ACCOUNT_NAME is defined
    fail_msg: "SERVICE_ACCOUNT_NAME must be provided"

- name: Assert SERVICE_ACCOUNT_FILE_PATH is provided
  assert:
    that:
    - SERVICE_ACCOUNT_FILE_PATH is defined
    fail_msg: "SERVICE_ACCOUNT_FILE_PATH must be provided"


- name: Login with service account
  shell: |
    gcloud auth activate-service-account {{ SERVICE_ACCOUNT_NAME }} --key-file {{ SERVICE_ACCOUNT_FILE_PATH }}

