---
# tasks file for gcp_auth_service_account_activate

- name: Assert  GCLOUD_SERVICE_ACCOUNT is provided
  assert:
    that:
    -  GCLOUD_SERVICE_ACCOUNT is defined
    fail_msg: " GCLOUD_SERVICE_ACCOUNT must be provided"

- name: Assert SERVICE_ACCOUNT_FILE_PATH is provided
  assert:
    that:
    - SERVICE_ACCOUNT_FILE_PATH is defined
    fail_msg: "SERVICE_ACCOUNT_FILE_PATH must be provided"


- name: Login with service account
  shell: |
    gcloud auth activate-service-account {{  GCLOUD_SERVICE_ACCOUNT }} --key-file {{ SERVICE_ACCOUNT_FILE_PATH }}

