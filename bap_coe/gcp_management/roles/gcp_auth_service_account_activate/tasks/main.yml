---
# tasks file for gcp_auth_service_account_activate

- name: Assert SERVICE_ACCOUNT_EMAIL is provided
  assert:
    that:
    - SERVICE_ACCOUNT_EMAIL is defined
    fail_msg: "SERVICE_ACCOUNT_EMAIL must be provided"
- debug:
    var: SERVICE_ACCOUNT_EMAIL
- name: Assert SERVICE_ACCOUNT_FILE_PATH is provided
  assert:
    that:
    - SERVICE_ACCOUNT_FILE_PATH is defined
    fail_msg: "SERVICE_ACCOUNT_FILE_PATH must be provided"


- name: Login with service account
  shell: |
    gcloud auth activate-service-account {{ SERVICE_ACCOUNT_EMAIL }} --key-file {{ SERVICE_ACCOUNT_FILE_PATH }}

