---
# tasks file for gce_instance_remove
- name: Capture start if available
  set_fact:
    start_pos: "{{ INSTANCE_COUNT_START | default(1) }}"

- name: remove an instance
  gcp_compute_instance:
    name: "{{ NAME_INSTANCE_PREFIX }}-{{ sequence | default(start_pos) }}"
    state: absent
    zone: "{{ GCP_ZONE }}"
    project: "{{ PROJECT_ID }}"
    auth_kind: "{{ AUTHORIZATION_KIND | default('serviceaccount') }}"
    service_account_file: "{{ SERVICE_ACCOUNT_FILE }}"
#    poll: 0
#    async: 300