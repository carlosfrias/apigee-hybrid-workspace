---
# tasks file for roles/apigee-hybrid-gke-create
- block:
  - name: Delete cluster from kubectl config
    shell: kubectl config delete-cluster {{ FQ_CLUSTER_NAME }}
    poll: 0
    retries: 50
    async: 90

  rescue:
    - name: RESCUE - Delete cluster from kubectl config
      ignore_errors: true
      shell: kubectl config delete-cluster {{ FQ_CLUSTER_NAME }}
      poll: 0
      retries: 50
      async: 90

- block:
  - name: Delete context from kubectl config
    shell: kubectl config delete-context {{ CLUSTER_NAME }}
    poll: 0
    retries: 50
    async: 90

  rescue:
    - name: RESCUE - Delete context from kubectl config
      ignore_errors: true
      shell: kubectl config delete-context {{ CLUSTER_NAME }}
      poll: 0
      retries: 50
      async: 90
