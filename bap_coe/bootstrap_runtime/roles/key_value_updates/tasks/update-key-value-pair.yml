---
- name: Validate that key_value_pair is provided
  fail:
    msg: "Please provide a key_value_pair to update"
  when: item is not defined

- name: Validate that key_value_pair.key is provided
  fail:
    msg: "Please provide a item.key to update"
  when: item.key is not defined

- name: Validate that key_value_pair.value is provided
  fail:
    msg: "Please provide a item.value to update"
  when: item.value is not defined

- name: Validate that key_value_pair.file_name is provided
  fail:
    msg: "Please provide a item.file_name to update"
  when: item.file_name is not defined

- name: Update key value settings in target file
  lineinfile:
    backrefs: "yes"
    state: present
    regexp: '^{{ item.key }}(\s*){{ item.separator }}(\s*)(.*)'
    line: '{{ item.key }}\1{{ item.separator }}\2{{ item.value }}'
    path: "{{ item.file_name }}"
