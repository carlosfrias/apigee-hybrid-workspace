---
- name: Validate that key_value_pair is provided
  fail:
    msg: "Please provide a key_value_pair to update"
  when: key_value_pair is not defined

- name: Validate that key_value_pair.key is provided
  fail:
    msg: "Please provide a key_value_pair.key to update"
  when: key_value_pair.key is not defined

- name: Validate that key_value_pair.value is provided
  fail:
    msg: "Please provide a key_value_pair.value to update"
  when: key_value_pair.value is not defined

- name: Validate that key_value_pair.file_name is provided
  fail:
    msg: "Please provide a key_value_pair.file_name to update"
  when: key_value_pair.file_name is not defined

- name: Update defaults.sh with replace_address option for Cassandra
  lineinfile:
    backup: yes
    create: yes
    mode: 0644
    state: present
    regexp: "^{{ key_value_pair.key }}"
    line: '{{ key_value_pair.key }}.*{{ key_value_pair.separator }}.*{{ key_value_pair.value }}'
    dest: "{{ key_value_pair.file_name }}"
