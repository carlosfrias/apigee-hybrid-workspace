---
# tasks file for terraform_installer
- name: Update system packages
  apt:
    name: "{{ item }}"
    state: present
  with_items: "{{ system_packages }}"

- block:
  - name: Download repo key
    ansible.builtin.get_url:
      url:  "{{ cloud_google_gpg_key_url }}"
      dest: "{{ cloud_google_gpg_path }}"

#  - name: Add repo key
#    apt_key:
#      url: "{{ cloud_google_gpg_key_url }}"
#      state: present

  - name: Add repository
    ansible.builtin.apt_repository:
      repo: "{{ cloud_google_repo_config }}"
      state: present

- name: Install gcloud
  apt:
    name: google-cloud-cli
    state: present


