---
- name: Obtain server self report
  uri:
    url: http://localhost:{{ port }}/v1/servers/self
    username: '{{ opdk_user_email }}'
    password: '{{ opdk_user_pass }}'
  register: self_report

#- name: Obtain server self report for {{ server_type }}
#  opdk_server_self:
#    server_type: '{{ server_type }}'

- name: Construct self report variable name
  set_fact:
    self_report_name: 'edge_{{ server_type }}_self'

- name: Server self report
  debug:
    msg: "{{ hostvars[inventory_hostname][self_report_name] }}"
  when: self_report_name is defined