---
- name: Obtain server self report
  ansible.builtin.uri:
    url: http://localhost:{{ server_port }}/v1/servers/self
    url_username: '{{ opdk_user_email }}'
    url_password: '{{ opdk_user_pass }}'
    body_format: json
    return_content: true
  register: server_rpt


#- name: Obtain server self report
#  command: curl -v -u {{ opdk_user_email }}:{{ opdk_user_pass }} http://localhost:{{ server_port }}/v1/servers/self
#  register: server_rpt


- name: Show self type
  debug:
    msg: "server_rpt: {{ server_rpt.json }}"

- name: assign data
  set_fact:
    server_rpt: "{{ server_rpt.stdout | from_json }}"

- name: Show self var
  debug:
    var: server_rpt.uUID


- pause:


- name: Construct self report variable name
  set_fact:
    cacheable: yes
    server_uuid: '{{ server_rpt.json }}'

