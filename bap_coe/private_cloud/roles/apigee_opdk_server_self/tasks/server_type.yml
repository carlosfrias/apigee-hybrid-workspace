---
- name: Obtain server self report
  uri:
    url: http://localhost:{{ server_port }}/v1/servers/self
    url_username: '{{ opdk_user_email }}'
    url_password: '{{ opdk_user_pass }}'
  register: self

- name: Construct self report variable name
  set_fact:
    cacheable: yes
    server_self_info: '{{ self }}'


#- name: Obtain server self report for {{ server_type }}
#  opdk_server_self:

#    server_type: '{{ server_type }}'

#- name: Server self report
#  debug:
#    msg: "{{ hostvars[inventory_hostname][self_report_name] }}"
#  when: self_report_name is defined