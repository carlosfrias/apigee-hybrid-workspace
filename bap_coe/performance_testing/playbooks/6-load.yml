---
- name: Complete Bulk Load of Test Data for Products, Developers and Apps
  hosts: "{{ target_hosts }}"
  strategy: free
  serial: 3
  gather_facts: yes

  collections:
    - bap_coe.performance_testing
    - bap_coe.gcp_management

  vars_files:
    - "{{ playbook_dir }}/3-properties.yml"
    - "{{ '~' | expanduser }}/.apigee-secure/credentials.yml"

  tasks:
    - name: Controller for grouping requests
      tags: ['developers','products','apps_create','apps_keys_create','apps_products']
      include_tasks: 6-load-controller.yml
      with_sequence: "start={{ CONTROLLER_REQUEST_START }} end={{ CONTROLLER_REQUEST_END }}"
      loop_control:
        loop_var: current_request