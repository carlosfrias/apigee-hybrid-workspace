---
- name: Create GCP infrastructure and install helm
  hosts: localhost
  connection: local
  gather_facts: true
  environment:
    ENABLE_TURBO_MODE: 1

  vars_files:
  - ~/.apigee-secure/argolis-credentials.yml
  - "{{ playbook_dir | dirname | dirname }}/resources/attributes.yml"

  collections:
  - bap_coe.gcp_management
  - bap_coe.bootstrap_runtime

  roles:
  - { role: gcp_project_create }

  tasks:
    - name: Create binary dest folder
      file:
        path: "{{ item }}"
        state: directory
      with_items:
        - "{{ WORK_DIR }}"
        - "{{ HELM_BINARY_DEST }}"


